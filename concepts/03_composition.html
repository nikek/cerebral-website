<!DOCTYPE html><html class="ua_js_no"><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Cerebral</title><script>(function(e,c){e[c]=e[c].replace(/(ua_js_)no/g,"$1yes");})(document.documentElement,"className");</script><link rel="stylesheet" href="../css/styles.min.css"/><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:700,500,400"/><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Mono"/><link rel="shortcut icon" href="../favicon.ico"/><meta name="viewport" content="width=device-width,maximum-scale=1,initial-scale=1,user-scalable=no"/><meta name="format-detection" content="telephone=no"/><link name="apple-mobile-web-app-capable" content="yes"/></head><body class="page page_layout_concepts"><div class="page__header"><div class="head-nav"><a class="link link__control head-nav__home i-bem" data-bem='{"link":{}}' role="link" href="../"></a></div></div><div class="page__content"><div class="row"><div class="row__col row__col_sw_24 row__col_lw_5"><div class="side-nav"><div class="menu menu_theme_islands menu_size_xl menu_mode_radio menu__control i-bem" data-bem='{"menu":{}}' role="menu" tabindex="0"><div class="menu__group" role="group" aria-labelledby="uniq1475007162595190"><div class="menu__group-title" role="presentation" id="uniq1475007162595190">Get started</div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"get-started/01_get-started"}}' role="menuitemradio" id="uniq1475007162595191" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../get-started/01_get-started.html">Get started</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"get-started/02_store-state"}}' role="menuitemradio" id="uniq1475007162595192" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../get-started/02_store-state.html">Store state</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"get-started/03_render-state"}}' role="menuitemradio" id="uniq1475007162595193" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../get-started/03_render-state.html">Render state</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"get-started/04_update-state"}}' role="menuitemradio" id="uniq1475007162595194" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../get-started/04_update-state.html">Update state</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"get-started/05_challenge"}}' role="menuitemradio" id="uniq1475007162595195" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../get-started/05_challenge.html">Challenge</a></div></div><div class="menu__group" role="group" aria-labelledby="uniq1475007162595196"><div class="menu__group-title" role="presentation" id="uniq1475007162595196">Concepts</div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"concepts/01_the-architecture"}}' role="menuitemradio" id="uniq1475007162595197" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../concepts/01_the-architecture.html">The architecture</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"concepts/02_signals"}}' role="menuitemradio" id="uniq1475007162595198" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../concepts/02_signals.html">Signals</a></div><div class="menu-item menu-item_type_link menu-item_checked menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"concepts/03_composition"}}' role="menuitemradio" id="uniq1475007162595199" aria-checked="true"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../concepts/03_composition.html">Composition</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"concepts/04_namespacing"}}' role="menuitemradio" id="uniq1475007162595200" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../concepts/04_namespacing.html">Namespacing</a></div></div><div class="menu__group" role="group" aria-labelledby="uniq1475007162595201"><div class="menu__group-title" role="presentation" id="uniq1475007162595201">Getting real</div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"getting-real/01_organizing"}}' role="menuitemradio" id="uniq1475007162595202" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../getting-real/01_organizing.html">Organizing</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"getting-real/02_routing"}}' role="menuitemradio" id="uniq1475007162595203" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../getting-real/02_routing.html">Routing</a></div></div><div class="menu__group" role="group" aria-labelledby="uniq1475007162595204"><div class="menu__group-title" role="presentation" id="uniq1475007162595204">API</div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"api/01_controller"}}' role="menuitemradio" id="uniq1475007162595205" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../api/01_controller.html">Controller</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"api/02_state"}}' role="menuitemradio" id="uniq1475007162595206" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../api/02_state.html">State</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"api/03_signals"}}' role="menuitemradio" id="uniq1475007162595207" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../api/03_signals.html">Signals</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"api/04_modules"}}' role="menuitemradio" id="uniq1475007162595208" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../api/04_modules.html">Modules</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"api/05_operators"}}' role="menuitemradio" id="uniq1475007162595209" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../api/05_operators.html">Operators</a></div><div class="menu-item menu-item_type_link menu-item_theme_islands i-bem" data-bem='{"menu-item":{"val":"api/06_providers"}}' role="menuitemradio" id="uniq1475007162595210" aria-checked="false"><a class="link link__control i-bem" data-bem='{"link":{}}' role="link" href="../api/06_providers.html">Providers</a></div></div></div></div></div><div class="row__col row__col_sw_24 row__col_lw_18 row__col_lo_1"><div class="page__edit"><a class="link link_theme_islands link__control i-bem" data-bem='{"link":{}}' role="link" href="https://github.com/cerebral/cerebral-website/edit/v3/content/concepts/03_composition.en.md">Edit on GitHub</a></div><h2 class="heading heading_lvl_2" id="composition">Composition</h2>
<p class="paragraph">Composition is a general term. With code it has two practical meanings.</p>
<ol class="list list_type_ordered">
<li class="list__item"><p class="paragraph">Creating functions that can be composed</p>
</li>
<li class="list__item"><p class="paragraph">Composing functions</p>
</li>
</ol>
<p class="paragraph">Typically we think of composition in functional programming. Like when you:</p>
<pre><code class="code" class="lang-js"> <span class="token keyword" >const</span> namesUpperDashSeparated <span class="token operator" >=</span> <span class="token punctuation" >(</span>
   somePeople
    <span class="token punctuation" >.</span><span class="token function" >map</span><span class="token punctuation" >(</span><span class="token function" >take</span><span class="token punctuation" >(</span><span class="token string" >'name'</span><span class="token punctuation" >)</span><span class="token punctuation" >)</span>
    <span class="token punctuation" >.</span><span class="token function" >map</span><span class="token punctuation" >(</span>toUpperCase<span class="token punctuation" >)</span>
    <span class="token punctuation" >.</span><span class="token function" >reduce</span><span class="token punctuation" >(</span>dashSeparated<span class="token punctuation" >,</span> <span class="token string" >''</span><span class="token punctuation" >)</span>
 <span class="token punctuation" >)</span>
</code></pre>
<p class="paragraph">Here we define functions that can be composed in many different scenarios. We compose using the array chaining of methods. So the functions defined are compatible with this type of composition.</p>
<p class="paragraph">Cerebral signals are also composable, but not with chaining like an array.</p>
<h3 class="heading heading_lvl_3" id="create-a-signal-compatible-function-action-">Create a signal compatible function (action)</h3>
<p class="paragraph">Like the <strong>toUpperCase</strong> function above requires the input to be a string, so does signal functions have requirements. There are basically three rules.</p>
<p class="paragraph"><strong>1</strong>. The function should operate on the <strong>context</strong> argument</p>
<pre><code class="code" class="lang-js"><span class="token keyword" >function</span> <span class="token function" >someAction</span><span class="token punctuation" >(</span><span class="token punctuation" >{</span>input<span class="token punctuation" >,</span> state<span class="token punctuation" >,</span> path<span class="token punctuation" >}</span><span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
  <span class="token comment" spellcheck="true">// Can only operate on what is passed on context</span>
<span class="token punctuation" >}</span>
</code></pre>
<p class="paragraph"><strong>2</strong>. Any returned value from the function needs to be an object. This is because it needs to be merged with the existing input</p>
<pre><code class="code" class="lang-js"><span class="token keyword" >function</span> <span class="token function" >someAction</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
  <span class="token keyword" >return</span> <span class="token punctuation" >{</span>foo<span class="token punctuation" >:</span> <span class="token string" >'bar'</span><span class="token punctuation" >}</span>
<span class="token punctuation" >}</span>
</code></pre>
<p class="paragraph"><strong>3</strong>. Any async behaviour requires the function to return a promise or be defined as an async function</p>
<pre><code class="code" class="lang-js"><span class="token keyword" >function</span> <span class="token function" >someAction</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
  <span class="token keyword" >return</span> <span class="token keyword" >new</span> <span class="token class-name" >Promise</span><span class="token punctuation" >(</span><span class="token punctuation" >(</span>resolve<span class="token punctuation" >)</span> <span class="token operator" >=</span><span class="token operator" >></span> <span class="token punctuation" >{</span>
    <span class="token function" >setTimeout</span><span class="token punctuation" >(</span>resolve<span class="token punctuation" >,</span> <span class="token number" >1000</span><span class="token punctuation" >)</span>
  <span class="token punctuation" >}</span><span class="token punctuation" >)</span>
<span class="token punctuation" >}</span>

<span class="token keyword" >async</span> <span class="token keyword" >function</span> <span class="token function" >someAction</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span> <span class="token punctuation" >{</span>
  <span class="token keyword" >const</span> data <span class="token operator" >=</span> <span class="token keyword" >await</span> <span class="token function" >getData</span><span class="token punctuation" >(</span><span class="token punctuation" >)</span>

  <span class="token keyword" >return</span> <span class="token punctuation" >{</span>data<span class="token punctuation" >}</span>
<span class="token punctuation" >}</span>
</code></pre>
<h3 class="heading heading_lvl_3" id="compose">Compose</h3>
<p class="paragraph">You have already seen examples of composition. Defining a signal is composition by default.</p>
<pre><code class="code" class="lang-js"><span class="token punctuation" >[</span>
  doThis<span class="token punctuation" >,</span>
  doThat
<span class="token punctuation" >]</span>
</code></pre>
<p class="paragraph">Both <strong>doThis</strong> and <strong>doThat</strong> can be used in any other signal as well. But not only actions can be composed into a signal, also chains can be composed into signals.</p>
<p class="paragraph">So lets say you have two different chains fetching some data and updating some state. You can compose these into one signal with:</p>
<pre><code class="code" class="lang-js"><span class="token punctuation" >[</span>
  <span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>fetchThis<span class="token punctuation" >,</span>
  <span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>fetchThat
<span class="token punctuation" >]</span>
</code></pre>
<p class="paragraph">Since both <strong>fetchThis</strong> and <strong>fetchThat</strong> are chains (arrays) they can be merged into the same chain using the spread operator. The code above actually looks something like:</p>
<pre><code class="code" class="lang-js"><span class="token punctuation" >[</span>
  fetchThis<span class="token punctuation" >,</span> <span class="token punctuation" >{</span>
    success<span class="token punctuation" >:</span> <span class="token punctuation" >[</span><span class="token punctuation" >]</span><span class="token punctuation" >,</span>
    error<span class="token punctuation" >:</span> <span class="token punctuation" >[</span><span class="token punctuation" >]</span>
  <span class="token punctuation" >}</span><span class="token punctuation" >,</span>
  fetchThat<span class="token punctuation" >,</span> <span class="token punctuation" >{</span>
    success<span class="token punctuation" >:</span> <span class="token punctuation" >[</span><span class="token punctuation" >]</span><span class="token punctuation" >,</span>
    error<span class="token punctuation" >:</span> <span class="token punctuation" >[</span><span class="token punctuation" >]</span>
  <span class="token punctuation" >}</span>
<span class="token punctuation" >]</span>
</code></pre>
<p class="paragraph">If you wanted the two to run in parallel you would just group them.</p>
<pre><code class="code" class="lang-js"><span class="token punctuation" >[</span>
  <span class="token punctuation" >[</span>
    <span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>fetchThis<span class="token punctuation" >,</span>
    <span class="token punctuation" >.</span><span class="token punctuation" >.</span><span class="token punctuation" >.</span>fetchThat  
  <span class="token punctuation" >]</span>
<span class="token punctuation" >]</span>
</code></pre>
</div></div></div><footer class="footer page__footer"><div class="row"><div class="row__col row__col_sw_24 row__col_lw_6"><h4 class="footer__header">ORGANIZATION</h4><a class="link link__control footer__link i-bem" data-bem='{"link":{}}' role="link" href="../contributors">Contributors</a></div><div class="row__col row__col_sw_24 row__col_lw_6 row__col_lo_3"><h4 class="footer__header">ARTICLES AND USEFUL LINKS</h4></div><div class="row__col row__col_sw_24 row__col_lw_6 row__col_lo_6"><h4 class="footer__header">HELP</h4></div></div></footer><script src="../js/scripts.min.js"></script></body></html>